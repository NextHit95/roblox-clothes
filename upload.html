<script>
  // Local array to store cloths
  let clothItems = [];

  const uploadForm = document.getElementById('upload-form');

  uploadForm.addEventListener('submit', function(e) {
    e.preventDefault(); // prevent page refresh

    // Get values from form
    const id = uploadForm.id.value.trim();
    const name = uploadForm.name.value.trim();
    const creatorId = uploadForm.creatorId.value.trim();
    const image = uploadForm.image.value.trim() || "https://via.placeholder.com/150";

    // Simple validation
    if(!id || !name || !creatorId) {
      alert("Please fill in all required fields.");
      return;
    }

    // Add new cloth object to local array
    const newCloth = {
      id,
      title: name,
      creatorId,
      image,
      likes: 0,
      views: 0,
      todayPick: false,
      hidden: false,
      createdAt: Date.now()
    };

    clothItems.push(newCloth);

    // Clear form
    uploadForm.reset();

    alert("Cloth uploaded locally! Refresh will reset it unless saved to DB.");
    console.log("Current cloth items:", clothItems);

    // Optional: render a preview gallery
    renderPreviewGallery();
  });

  function renderPreviewGallery() {
    let gallery = document.getElementById('previewGallery');
    if(!gallery){
      gallery = document.createElement('div');
      gallery.id = 'previewGallery';
      gallery.className = 'gallery';
      document.querySelector('main.container').appendChild(gallery);
    }

    // Clear existing gallery
    gallery.innerHTML = '';

    // Render all cloths
    clothItems.forEach(item => {
      const div = document.createElement('div');
      div.className = 'item';
      div.innerHTML = `
        <img src="${item.image}" alt="${item.title}">
        <p>${item.title}</p>
        <small>Creator ID: ${item.creatorId}</small>
      `;
      gallery.appendChild(div);
    });
  }
</script>
